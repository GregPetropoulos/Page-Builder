{"ast":null,"code":"import _regeneratorRuntime from\"/Users/gregpetropoulos/CodingBootcamp/Page-Builder-Project-3/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/gregpetropoulos/CodingBootcamp/Page-Builder-Project-3/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/Users/gregpetropoulos/CodingBootcamp/Page-Builder-Project-3/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/gregpetropoulos/CodingBootcamp/Page-Builder-Project-3/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/gregpetropoulos/CodingBootcamp/Page-Builder-Project-3/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{forwardRef,useMemo,useRef,useState}from'react';import{useHistory,useParams}from'react-router-dom';import pagesService from'../services/pages';import{TemplatePanel}from'./TemplatePanel';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var TemplateProvider=/*#__PURE__*/forwardRef(function(_ref,ref){var children=_ref.children;return/*#__PURE__*/_jsxs(\"div\",{ref:ref,children:[/*#__PURE__*/_jsx(\"link\",{href:\"https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css\",rel:\"stylesheet\"}),children]});});export var TemplateEditor=function TemplateEditor(_ref2){var configs=_ref2.configs;var _useParams=useParams(),id=_useParams.id;var history=useHistory();var templateRef=useRef(null);var config=useMemo(function(){return configs.filter(function(config){return config.id===parseInt(id);})[0];},[id,configs]);var _useState=useState(config.fields),_useState2=_slicedToArray(_useState,2),fields=_useState2[0],setFields=_useState2[1];var onChange=function onChange(fieldId,value){setFields(function(prev){var result=prev.map(function(field){return field.id===fieldId?_objectSpread(_objectSpread({},field),{},{value:value}):field;});return result;});};var Template=config.component;var templateFields=fields.reduce(function(result,field){return _objectSpread(_objectSpread({},result),{},_defineProperty({},field.id,field.value));},{});var handleSave=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var html,pageTitle,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:html=templateRef.current.innerHTML;pageTitle=fields.filter(function(f){return f.id==='pageTitle';});_context.next=4;return pagesService.createPage(pageTitle.length>0?pageTitle[0].value:config.name,config.thumbnail,html);case 4:response=_context.sent;history.push('/');case 6:case\"end\":return _context.stop();}}},_callee);}));return function handleSave(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(TemplatePanel,{fields:fields,onChange:onChange,onSave:handleSave}),/*#__PURE__*/_jsx(TemplateProvider,{ref:templateRef,children:/*#__PURE__*/_jsx(Template,_objectSpread({},templateFields))})]});};","map":{"version":3,"sources":["/Users/gregpetropoulos/CodingBootcamp/Page-Builder-Project-3/frontend/src/components/TemplateEditor.js"],"names":["forwardRef","useMemo","useRef","useState","useHistory","useParams","pagesService","TemplatePanel","TemplateProvider","ref","children","TemplateEditor","configs","id","history","templateRef","config","filter","parseInt","fields","setFields","onChange","fieldId","value","prev","result","map","field","Template","component","templateFields","reduce","handleSave","html","current","innerHTML","pageTitle","f","createPage","length","name","thumbnail","response","push"],"mappings":"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","sourcesContent":["import { forwardRef, useMemo, useRef, useState } from 'react';\r\nimport { useHistory, useParams } from 'react-router-dom';\r\nimport pagesService from '../services/pages';\r\nimport { TemplatePanel } from './TemplatePanel';\r\n\r\nconst TemplateProvider = forwardRef(({ children }, ref) => {\r\n\treturn (\r\n\t\t<div ref={ref}>\r\n\r\n\t\t\t<link href=\"https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css\" rel=\"stylesheet\"/>\r\n\t\t\t{children}\r\n\t\t</div>\r\n\t);\r\n});\r\n\r\nexport const TemplateEditor = ({ configs }) => {\r\n\tconst { id } = useParams();\r\n\tconst history = useHistory();\r\n\tconst templateRef = useRef(null);\r\n\r\n\tconst config = useMemo(\r\n\t\t() => configs.filter(config => config.id === parseInt(id))[0],\r\n\t\t[id, configs]\r\n\t);\r\n\r\n\tconst [fields, setFields] = useState(config.fields);\r\n\r\n\tconst onChange = (fieldId, value) => {\r\n\t\tsetFields(prev => {\r\n\t\t\tconst result = prev.map(field =>\r\n\t\t\t\tfield.id === fieldId ? { ...field, value: value } : field\r\n\t\t\t);\r\n\t\t\treturn result;\r\n\t\t});\r\n\t};\r\n\r\n\tconst Template = config.component;\r\n\tconst templateFields = fields.reduce(\r\n\t\t(result, field) => ({\r\n\t\t\t...result,\r\n\t\t\t[field.id]: field.value,\r\n\t\t}),\r\n\t\t{}\r\n\t);\r\n\r\n\tconst handleSave = async () => {\r\n\t\tconst html = templateRef.current.innerHTML;\r\n\t\tconst pageTitle = fields.filter(f => f.id === 'pageTitle');\r\n\t\tconst response = await pagesService.createPage(\r\n\t\t\tpageTitle.length > 0 ? pageTitle[0].value : config.name,\r\n\t\t\tconfig.thumbnail,\r\n\t\t\thtml\r\n\t\t);\r\n\t\thistory.push('/');\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<TemplatePanel\r\n\t\t\t\tfields={fields}\r\n\t\t\t\tonChange={onChange}\r\n\t\t\t\tonSave={handleSave}\r\n\t\t\t></TemplatePanel>\r\n\t\t\t<TemplateProvider ref={templateRef}>\r\n\t\t\t\t<Template {...templateFields} />\r\n\t\t\t</TemplateProvider>\r\n\t\t</div>\r\n\t);\r\n};\r\n"]},"metadata":{},"sourceType":"module"}